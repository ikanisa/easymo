# Netlify Configuration for EasyMO Admin Panel
# Next.js 15 in a pnpm monorepo

[build]
  # Set base to admin-app so the Netlify Next.js plugin can find the app
  base = "admin-app"
  # Build workspace dependencies from root, then build the admin app
  command = "cd .. && pnpm install --frozen-lockfile && pnpm --filter @va/shared build && pnpm --filter @easymo/commons build && pnpm --filter @easymo/video-agent-schema build && cd admin-app && npm ci && npm run build"

[build.environment]
  NODE_VERSION = "20"
  PNPM_VERSION = "10.18.3"

# The @netlify/plugin-nextjs plugin automatically handles Next.js deployment
# It creates Netlify Functions for server-side rendering and API routes
[[plugins]]
  package = "@netlify/plugin-nextjs"
