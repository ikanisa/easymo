â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                   MY BUSINESS WORKFLOW - ARCHITECTURE                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          USER JOURNEY FLOW                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    ğŸ‘¤ User on WhatsApp
         â”‚
         â”œâ”€â”€ "Profile" â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                                   â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
    â”‚   Profile Home (Dynamic Menu)       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚   wa-webhook-profile/profile/       â”‚
    â”‚   home_dynamic.ts                   â”‚
    â”‚                                     â”‚
    â”‚   âœ… Database-driven menu           â”‚
    â”‚   âœ… Country-aware                  â”‚
    â”‚   âœ… Language support (5 langs)     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€ Select "My Businesses"
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Business List                     â”‚
    â”‚   wa-webhook-profile/business/      â”‚
    â”‚   list.ts (200 LOC)                 â”‚
    â”‚                                     â”‚
    â”‚   âœ… Shows owned businesses         â”‚
    â”‚   âœ… Grouped by category            â”‚
    â”‚   âœ… Empty state handling           â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€ Select Business (id: "biz::123")
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Business Detail                   â”‚
    â”‚   wa-webhook/domains/business/      â”‚
    â”‚   management.ts (404 LOC)           â”‚
    â”‚                                     â”‚
    â”‚   Options shown based on type:      â”‚
    â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
    â”‚   â”‚ Restaurant/Bar:              â”‚  â”‚
    â”‚   â”‚  â€¢ ğŸ“‹ Manage Menu            â”‚  â”‚
    â”‚   â”‚  â€¢ ğŸ“¦ View Orders            â”‚  â”‚
    â”‚   â”‚                              â”‚  â”‚
    â”‚   â”‚ All Businesses:              â”‚  â”‚
    â”‚   â”‚  â€¢ âœï¸ Edit Details           â”‚  â”‚
    â”‚   â”‚  â€¢ ğŸ”— Share Link             â”‚  â”‚
    â”‚   â”‚  â€¢ ğŸ—‘ï¸ Delete Business        â”‚  â”‚
    â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€ Select "Manage Menu" (Restaurant only)
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Restaurant Manager                â”‚
    â”‚   wa-webhook/domains/vendor/        â”‚
    â”‚   restaurant.ts (800+ LOC)          â”‚
    â”‚                                     â”‚
    â”‚   Features:                         â”‚
    â”‚   âœ… View menu items                â”‚
    â”‚   âœ… Add new items                  â”‚
    â”‚   âœ… Edit prices                    â”‚
    â”‚   âœ… Toggle availability            â”‚
    â”‚   âœ… Delete items                   â”‚
    â”‚   âš ï¸  Upload menu (OCR placeholder) â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€ Customer can order from menu
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   Menu Ordering (Customer Side)     â”‚
    â”‚   wa-webhook/domains/orders/        â”‚
    â”‚   menu_order.ts (400 LOC)           â”‚
    â”‚                                     â”‚
    â”‚   âœ… Browse menu                    â”‚
    â”‚   âœ… Add to cart                    â”‚
    â”‚   âœ… Checkout                       â”‚
    â”‚   âœ… Order confirmation             â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â””â”€â–º Desktop App (Bar Manager)
             â””â”€â–º Real-time order updates


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          TECHNICAL STACK                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 1: Profile Microservice (wa-webhook-profile)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  index.ts (1189 LOC) â”€â”€â”€â”€â”€â”€â”€â”€â–º Main Router                                  â”‚
â”‚     â”‚                                                                        â”‚
â”‚     â”œâ”€â–º profile/                                                            â”‚
â”‚     â”‚    â”œâ”€ home.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Static profile home                        â”‚
â”‚     â”‚    â”œâ”€ home_dynamic.ts â”€â”€â”€â–º âœ… Dynamic DB-driven menu (251 LOC)        â”‚
â”‚     â”‚    â”œâ”€ edit.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Profile editing                            â”‚
â”‚     â”‚    â””â”€ locations.ts â”€â”€â”€â”€â”€â”€â–º Saved locations                            â”‚
â”‚     â”‚                                                                        â”‚
â”‚     â”œâ”€â–º business/                                                           â”‚
â”‚     â”‚    â”œâ”€ index.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Exports                                    â”‚
â”‚     â”‚    â”œâ”€ list.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… List + create (200 LOC)                 â”‚
â”‚     â”‚    â”œâ”€ create.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Name input handler                      â”‚
â”‚     â”‚    â”œâ”€ update.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Edit fields                             â”‚
â”‚     â”‚    â””â”€ delete.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Soft delete                             â”‚
â”‚     â”‚                                                                        â”‚
â”‚     â”œâ”€â–º wallet/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Complete (7 handlers)                 â”‚
â”‚     â”œâ”€â–º jobs/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Complete (CRUD)                       â”‚
â”‚     â”œâ”€â–º properties/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Complete (CRUD)                       â”‚
â”‚     â””â”€â–º vehicles/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Complete (add, list)                  â”‚
â”‚                                                                              â”‚
â”‚  âš ï¸  INTEGRATION GAP: Missing routing for:                                  â”‚
â”‚     â€¢ BUSINESS_MANAGE_MENU                                                  â”‚
â”‚     â€¢ BUSINESS_VIEW_ORDERS                                                  â”‚
â”‚     â€¢ biz::* (business selection)                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                     â†“â†“â†“
                          Forwards business actions to
                                     â†“â†“â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 2: Main Webhook (wa-webhook)                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  domains/                                                                    â”‚
â”‚     â”œâ”€â–º business/                                                           â”‚
â”‚     â”‚    â”œâ”€ management.ts â”€â”€â”€â”€â”€â”€â–º âœ… Business detail (404 LOC)              â”‚
â”‚     â”‚    â”‚                         â€¢ showManageBusinesses()                 â”‚
â”‚     â”‚    â”‚                         â€¢ showBusinessDetail()                   â”‚
â”‚     â”‚    â”‚                         â€¢ handleBusinessDelete()                 â”‚
â”‚     â”‚    â”‚                                                                  â”‚
â”‚     â”‚    â”œâ”€ deeplink.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Sharing functionality                 â”‚
â”‚     â”‚    â”œâ”€ edit.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Edit business details                  â”‚
â”‚     â”‚    â”œâ”€ claim.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Claim existing business                â”‚
â”‚     â”‚    â”œâ”€ add_new.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Add new business                       â”‚
â”‚     â”‚    â””â”€ whatsapp_numbers.ts â–º âœ… Manage contact numbers                 â”‚
â”‚     â”‚                                                                        â”‚
â”‚     â”œâ”€â–º vendor/                                                             â”‚
â”‚     â”‚    â”œâ”€ restaurant.ts â”€â”€â”€â”€â”€â”€â”€â–º âœ… Menu management (800+ LOC)            â”‚
â”‚     â”‚    â”‚                         â€¢ startRestaurantManager()               â”‚
â”‚     â”‚    â”‚                         â€¢ showCurrentMenu()                      â”‚
â”‚     â”‚    â”‚                         â€¢ promptMenuUpload() âš ï¸ OCR TODO         â”‚
â”‚     â”‚    â”‚                         â€¢ startMenuEditor()                      â”‚
â”‚     â”‚    â”‚                                                                  â”‚
â”‚     â”‚    â””â”€ wallet.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º âœ… Vendor wallet integration             â”‚
â”‚     â”‚                                                                        â”‚
â”‚     â””â”€â–º orders/                                                             â”‚
â”‚          â””â”€ menu_order.ts â”€â”€â”€â”€â”€â”€â”€â–º âœ… Customer ordering (400 LOC)           â”‚
â”‚                                    â€¢ startMenuOrderSession()                â”‚
â”‚                                    â€¢ handleMenuItemSelection()              â”‚
â”‚                                                                              â”‚
â”‚  âœ… READY: All handlers implemented                                         â”‚
â”‚  âš ï¸  TODO: Wire to profile service                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                     â†“â†“â†“
                                 Reads/Writes
                                     â†“â†“â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 3: Supabase Database                                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  Tables:                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ business         â”‚ Main business data                               â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ owner_user_id, owner_whatsapp                  â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ name, description, category_name               â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ location_text, lat, lng                        â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ bar_id (FK to bars table)                      â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ tag, business_type                             â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ is_active (soft delete)                        â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ bar_managers     â”‚ Authorization for menu management                â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ bar_id, user_id                                â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ role (owner, manager, staff)                   â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ is_active                                      â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ menu_items       â”‚ Restaurant menu items                            â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ bar_id, name, description                      â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ category_name, price, currency                 â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ is_available, image_url                        â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ display_order                                  â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ orders           â”‚ Customer orders                                  â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ customer_phone, customer_user_id               â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ bar_id, status                                 â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ total_amount, currency                         â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ notes, delivery_address                        â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ order_items      â”‚ Order line items                                 â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ order_id, menu_item_id                         â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ menu_item_name (snapshot)                      â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ quantity, unit_price, subtotal                 â”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ profile_menu_    â”‚ Dynamic profile menu configuration               â”‚   â”‚
â”‚  â”‚ items            â”‚ â€¢ item_key, display_order                        â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ icon, title_*, description_*                   â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ action_type, action_target                     â”‚   â”‚
â”‚  â”‚                  â”‚ â€¢ available_countries, enabled                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â”‚  Real-time Subscriptions:                                                   â”‚
â”‚  â€¢ orders table â”€â”€â”€â”€â”€â–º Desktop app receives new orders                      â”‚
â”‚  â€¢ menu_items table â”€â–º Sync between WhatsApp & desktop                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                                     â†“â†“â†“
                            Real-time subscriptions
                                     â†“â†“â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 4: Bar Manager Desktop App (Next.js 14)                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  bar-manager-app/ (3096 LOC)                                                â”‚
â”‚     â”‚                                                                        â”‚
â”‚     â”œâ”€â–º app/                                                                â”‚
â”‚     â”‚    â”œâ”€ page.tsx â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Dashboard (analytics, stats)               â”‚
â”‚     â”‚    â”œâ”€ menu/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Menu management UI                         â”‚
â”‚     â”‚    â”œâ”€ orders/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Order management UI                        â”‚
â”‚     â”‚    â””â”€ settings/ â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º Settings & preferences                     â”‚
â”‚     â”‚                                                                        â”‚
â”‚     â”œâ”€â–º components/                                                         â”‚
â”‚     â”‚    â”œâ”€ OrderCard.tsx â”€â”€â”€â”€â”€â–º Real-time order display                    â”‚
â”‚     â”‚    â”œâ”€ MenuEditor.tsx â”€â”€â”€â”€â–º Menu CRUD UI                               â”‚
â”‚     â”‚    â””â”€ Dashboard.tsx â”€â”€â”€â”€â”€â–º Analytics & summary                        â”‚
â”‚     â”‚                                                                        â”‚
â”‚     â”œâ”€â–º hooks/                                                              â”‚
â”‚     â”‚    â”œâ”€ useOrders.ts â”€â”€â”€â”€â”€â”€â–º Supabase realtime subscription            â”‚
â”‚     â”‚    â”œâ”€ useMenu.ts â”€â”€â”€â”€â”€â”€â”€â”€â–º Menu management hooks                      â”‚
â”‚     â”‚    â””â”€ useAuth.ts â”€â”€â”€â”€â”€â”€â”€â”€â–º Bar manager authentication                 â”‚
â”‚     â”‚                                                                        â”‚
â”‚     â””â”€â–º lib/                                                                â”‚
â”‚          â”œâ”€ supabase.ts â”€â”€â”€â”€â”€â”€â”€â”€â–º Client configuration                      â”‚
â”‚          â””â”€ api.ts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º RPC calls                                 â”‚
â”‚                                                                              â”‚
â”‚  Features:                                                                   â”‚
â”‚  âœ… Real-time order notifications                                           â”‚
â”‚  âœ… Menu item management (CRUD)                                             â”‚
â”‚  âœ… Order status updates                                                    â”‚
â”‚  âœ… Analytics dashboard                                                     â”‚
â”‚  âš ï¸  TODO: Magic link authentication from WhatsApp                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          DATA FLOW DIAGRAM                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Customer (WhatsApp)          Bar Manager (WhatsApp)        Bar Manager (Desktop)
       â”‚                              â”‚                              â”‚
       â”‚  1. "Show menu"              â”‚                              â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                              â”‚
       â”‚                              â”‚                              â”‚
       â”‚  2. Menu items               â”‚                              â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                              â”‚
       â”‚     (from menu_items)        â”‚                              â”‚
       â”‚                              â”‚                              â”‚
       â”‚  3. "Add Pizza"              â”‚                              â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                              â”‚
       â”‚                              â”‚                              â”‚
       â”‚  4. "Checkout"               â”‚                              â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                              â”‚
       â”‚                              â”‚                              â”‚
       â”‚                              â”‚  5. New Order Created        â”‚
       â”‚                              â”‚  (orders table INSERT)       â”‚
       â”‚                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
       â”‚                              â”‚                              â”‚
       â”‚                              â”‚                              â”‚  6. Desktop
       â”‚                              â”‚                              â”‚     Notification
       â”‚                              â”‚                              â”‚     ğŸ””
       â”‚                              â”‚                              â”‚
       â”‚                              â”‚  7. Update Status            â”‚
       â”‚                              â”‚     "Preparing"              â”‚
       â”‚                              â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
       â”‚                              â”‚  (orders table UPDATE)       â”‚
       â”‚                              â”‚                              â”‚
       â”‚  8. WhatsApp Notification    â”‚                              â”‚
       â”‚     "Order confirmed"        â”‚                              â”‚
       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                              â”‚
       â”‚                              â”‚                              â”‚
       â”‚                              â”‚                              â”‚
       â”‚  "My Businesses"             â”‚                              â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                              â”‚
       â”‚                              â”‚                              â”‚
       â”‚  "Manage Menu"               â”‚                              â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                              â”‚
       â”‚                              â”‚                              â”‚
       â”‚  "Add item: Burger"          â”‚                              â”‚
       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚                              â”‚
       â”‚                              â”‚                              â”‚
       â”‚                              â”‚  9. Menu Updated             â”‚
       â”‚                              â”‚  (menu_items INSERT)         â”‚
       â”‚                              â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
       â”‚                              â”‚                              â”‚
       â”‚                              â”‚                              â”‚  10. Real-time
       â”‚                              â”‚                              â”‚      Sync
       â”‚                              â”‚                              â”‚      âœ“
       â”‚                              â”‚                              â”‚


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          INTEGRATION GAPS                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GAP 1: Profile Service Routing âš ï¸                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  CURRENT:                                                                 â”‚
â”‚    wa-webhook-profile/index.ts handles:                                  â”‚
â”‚      âœ… MY_BUSINESSES â†’ listMyBusinesses()                               â”‚
â”‚      âŒ biz::* â†’ (not handled)                                           â”‚
â”‚      âŒ BUSINESS_MANAGE_MENU â†’ (not handled)                             â”‚
â”‚      âŒ BUSINESS_VIEW_ORDERS â†’ (not handled)                             â”‚
â”‚                                                                           â”‚
â”‚  SOLUTION: Add 15 lines of code to index.ts (see Quick Start)            â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GAP 2: Business Type Detection âš ï¸                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  CURRENT:                                                                 â”‚
â”‚    String matching on category_name/tag:                                 â”‚
â”‚      slug.includes("bar") || slug.includes("restaurant")                 â”‚
â”‚                                                                           â”‚
â”‚  ISSUES:                                                                  â”‚
â”‚    â€¢ Fragile string matching                                             â”‚
â”‚    â€¢ No support for shops, pharmacies                                    â”‚
â”‚    â€¢ Hard to maintain                                                    â”‚
â”‚                                                                           â”‚
â”‚  SOLUTION: Add getBusinessType() utility function                        â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GAP 3: Menu Upload AI OCR âš ï¸                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  CURRENT:                                                                 â”‚
â”‚    Placeholder handler exists in restaurant.ts                           â”‚
â”‚    Shows "Upload menu" button but OCR not implemented                    â”‚
â”‚                                                                           â”‚
â”‚  SOLUTION: Phase 2 implementation                                        â”‚
â”‚    â€¢ Create menu_upload_requests table                                   â”‚
â”‚    â€¢ Add ocr-processor edge function                                     â”‚
â”‚    â€¢ Use Gemini Vision API                                               â”‚
â”‚    â€¢ Add review & import flow                                            â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GAP 4: Desktop App Authentication âš ï¸                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                           â”‚
â”‚  CURRENT:                                                                 â”‚
â”‚    Desktop app exists but no auth flow from WhatsApp                     â”‚
â”‚    No magic link generation                                              â”‚
â”‚                                                                           â”‚
â”‚  SOLUTION: Phase 3 implementation                                        â”‚
â”‚    â€¢ Generate JWT tokens from WhatsApp                                   â”‚
â”‚    â€¢ Add login handler in desktop app                                    â”‚
â”‚    â€¢ Implement deep linking                                              â”‚
â”‚                                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          COMPLETION ROADMAP                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    PHASE 1: Integration (2-3 days) â”€â”€â”€â”€â”€â”€â–º âš¡ START HERE
         â”‚
         â”œâ”€â–º Update wa-webhook-profile router (4 hours)
         â”œâ”€â–º Fix business selection flow (3 hours)
         â”œâ”€â–º Add business type detection (2 hours)
         â””â”€â–º Test end-to-end flow (8 hours)
         
         DELIVERABLE: Working Profile â†’ Business â†’ Menu flow
         STATUS: âš ï¸ Ready to implement


    PHASE 2: Menu Upload AI OCR (3-4 days)
         â”‚
         â”œâ”€â–º Create menu_upload_requests table (2 hours)
         â”œâ”€â–º Implement OCR handler (8 hours)
         â”œâ”€â–º Add review & import UI (6 hours)
         â””â”€â–º Implement bulk import (4 hours)
         
         DELIVERABLE: AI-powered menu upload
         STATUS: ğŸ“‹ Planned


    PHASE 3: Desktop Integration (4-5 days)
         â”‚
         â”œâ”€â–º Desktop app authentication (6 hours)
         â”œâ”€â–º Real-time order notifications (8 hours)
         â”œâ”€â–º Order status updates (6 hours)
         â””â”€â–º Menu sync between apps (4 hours)
         
         DELIVERABLE: Full desktop app integration
         STATUS: ğŸ“‹ Planned


    TOTAL TIMELINE: 10-12 days
    RISK: Low (leveraging existing code)
    ROI: High (immediate value)


â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                           QUICK REFERENCE                                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

FILES TO MODIFY (Phase 1):
  1. supabase/functions/wa-webhook-profile/index.ts          (+15 lines)
  2. supabase/functions/wa-webhook-profile/business/list.ts (+10 lines)
  3. supabase/functions/wa-webhook/domains/business/        (+30 lines)
     management.ts

TESTING:
  pnpm lint
  pnpm exec vitest run
  supabase functions deploy wa-webhook-profile
  
MANUAL TEST:
  WhatsApp â†’ "Profile" â†’ "My Businesses" â†’ Select business â†’ "Manage Menu"

SUCCESS CRITERIA:
  âœ… Menu editor opens for restaurant businesses
  âœ… Non-restaurants hide "Manage Menu" option
  âœ… Back navigation works at all levels

