# ═══════════════════════════════════════════════════════════════════════════════
# EASYMO MONOREPO - ENVIRONMENT CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════
# This file documents environment variables for the entire monorepo
# Copy to .env.local for local development
# Configure in Cloud Run / App Engine / Secret Manager for production
#
# ⚠️  SECURITY NOTICE:
# - NEVER commit .env.local or .env to git (add to .gitignore)
# - NEVER use NEXT_PUBLIC_* or VITE_* prefixes for sensitive values
# - Service role keys must ONLY be server-side
# - Use Secret Manager for production secrets
#
# Legend:
#   [REQUIRED]  - Must be set for core functionality
#   [SENSITIVE] - Contains secrets, use Secret Manager in production
#   [OPTIONAL]  - Has defaults or enables optional features
# ═══════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────
# SUPABASE CONFIGURATION [REQUIRED] [SENSITIVE]
# ─────────────────────────────────────────────────────────────────────────────
# Get from: Supabase Dashboard → Settings → API

# Public (client-side safe - can be in NEXT_PUBLIC_* or VITE_*)
NEXT_PUBLIC_SUPABASE_URL=https://your-project-ref.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key-here

# For Vite apps (PWAs)
VITE_SUPABASE_URL=https://your-project-ref.supabase.co
VITE_SUPABASE_ANON_KEY=your-supabase-anon-key-here
VITE_SUPABASE_PROJECT_ID=your-project-ref

# Server-only (NEVER use NEXT_PUBLIC_* or VITE_* prefix)
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_SERVICE_ROLE_KEY=your-supabase-service-role-key-here
SUPABASE_DB_URL=postgresql://postgres:password@db.your-project-ref.supabase.co:5432/postgres
SUPABASE_JWT_SECRET=your-jwt-secret

# ─────────────────────────────────────────────────────────────────────────────
# ADMIN AUTHENTICATION [REQUIRED] [SENSITIVE]
# ─────────────────────────────────────────────────────────────────────────────

# Admin API token for Edge Functions
EASYMO_ADMIN_TOKEN=your-admin-token-here

# Session encryption secret (MINIMUM 64 characters for production)
# Generate with: openssl rand -hex 32
ADMIN_SESSION_SECRET=your-session-secret-min-64-characters-required
ADMIN_SESSION_SECRET_FALLBACK=your-fallback-secret-for-key-rotation

# Admin credentials (JSON array)
# Generate hash: node -e "const bcrypt = require('bcrypt'); bcrypt.hash('password', 10).then(console.log);"
ADMIN_ACCESS_CREDENTIALS='[{"actorId":"00000000-0000-0000-0000-000000000000","email":"admin@example.com","passwordHash":"$2b$10$...","label":"Admin"}]'

# Admin invite settings
ADMIN_INVITE_DEFAULT_ROLE=member
ADMIN_INVITE_EXPIRY_DAYS=14

# WhatsApp flow ID for admin auth
ADMIN_FLOW_WA_ID=your-flow-id

# ─────────────────────────────────────────────────────────────────────────────
# WHATSAPP BUSINESS API [REQUIRED FOR MESSAGING] [SENSITIVE]
# ─────────────────────────────────────────────────────────────────────────────
# Meta WhatsApp Business API (NOT Twilio)
# Get from: Meta Business Suite → WhatsApp → Settings → API Access

# Primary credentials
WHATSAPP_ACCESS_TOKEN=your-permanent-access-token
WHATSAPP_PHONE_NUMBER_ID=your-phone-number-id
WHATSAPP_BUSINESS_ACCOUNT_ID=your-business-account-id
WHATSAPP_SYSTEM_USER_ID=your-system-user-id

# WhatsApp send endpoint (typically your Supabase Edge Function)
WHATSAPP_SEND_ENDPOINT=https://your-project.supabase.co/functions/v1/wa-webhook-core

# Alternative format (for compatibility)
WA_TOKEN=your-permanent-access-token
WA_PHONE_ID=your-phone-number-id
WA_VERIFY_TOKEN=your-webhook-verify-token
WA_APP_SECRET=your-app-secret

# WABA format
WABA_ACCESS_TOKEN=your-waba-access-token
WABA_PHONE_NUMBER_ID=your-phone-number-id
WABA_TEMPLATE_NAMESPACE=your-template-namespace
WABA_WEBHOOK_VERIFY_TOKEN=your-webhook-verify-token

# Template configuration
WHATSAPP_TEMPLATE_NAMESPACE=your-template-namespace
WA_TEMPLATE_LANG=en
WA_INSURANCE_ADMIN_TEMPLATE=insurance_admin_alert

# Admin bypass (DISABLE IN PRODUCTION)
WA_ADMIN_BYPASS_ENABLED=false
WA_ADMIN_BYPASS_IPS=

# ─────────────────────────────────────────────────────────────────────────────
# AI PROVIDERS [REQUIRED FOR AI FEATURES] [SENSITIVE]
# ─────────────────────────────────────────────────────────────────────────────
# ⚠️  MANDATORY MODELS:
#   - OpenAI: GPT-5 (for conversation, reasoning, intent classification)
#   - Google: Gemini-3 (for vision/OCR, document parsing, Maps integration)
#
# ❌ DO NOT USE deprecated models: gpt-4o, gpt-4-turbo, gemini-1.5-flash, etc.

# OpenAI GPT-5 (Required for AI conversation and reasoning)
OPENAI_API_KEY=sk-your-openai-api-key
OPENAI_ORG_ID=org-your-organization-id
# Model used: GPT-5 (automatically configured)
ENABLE_OPENAI_REALTIME=false

# Google Gemini-3 (Required for vision/OCR tasks)
GEMINI_API_KEY=AIza-your-gemini-api-key
# Model used: Gemini-3 (automatically configured)
ENABLE_GEMINI_LIVE=false

# Google Maps
GOOGLE_MAPS_API_KEY=AIza-your-google-maps-api-key

# Google Search (for AI grounding)
GOOGLE_SEARCH_API_KEY=AIza-your-google-search-api-key
GOOGLE_SEARCH_ENGINE_ID=your-custom-search-engine-id
ENABLE_GOOGLE_SEARCH_GROUNDING=false

# Google Cloud
GOOGLE_CLOUD_PROJECT=your-gcp-project-id

# Google Drive (for agent document sync)
GOOGLE_DRIVE_API_KEY=AIza-your-google-drive-api-key

# Other AI
SORA_API_KEY=your-sora-api-key
ENABLE_IMAGE_GENERATION=false

# ─────────────────────────────────────────────────────────────────────────────
# MICROSERVICES [OPTIONAL]
# ─────────────────────────────────────────────────────────────────────────────
# Internal service URLs

# Use NEXT_PUBLIC_* if services are client-accessible
NEXT_PUBLIC_AGENT_CORE_URL=http://localhost:3001
NEXT_PUBLIC_VOICE_BRIDGE_API_URL=http://localhost:3002
NEXT_PUBLIC_MARKETPLACE_RANKING_URL=http://localhost:3003
NEXT_PUBLIC_MARKETPLACE_VENDOR_URL=http://localhost:3004
NEXT_PUBLIC_MARKETPLACE_BUYER_URL=http://localhost:3005
NEXT_PUBLIC_WALLET_SERVICE_URL=http://localhost:3006
NEXT_PUBLIC_INSURANCE_SERVICE_URL=http://localhost:3007

# Server-side only versions (for API routes)
AGENT_CORE_URL=http://localhost:3001
VOICE_BRIDGE_API_URL=http://localhost:3002
MARKETPLACE_RANKING_URL=http://localhost:3003
MARKETPLACE_VENDOR_URL=http://localhost:3004
MARKETPLACE_BUYER_URL=http://localhost:3005
WALLET_SERVICE_URL=http://localhost:3006
INSURANCE_SERVICE_URL=http://localhost:3007

# ─────────────────────────────────────────────────────────────────────────────
# SECURITY TOKENS [REQUIRED FOR PRODUCTION] [SENSITIVE]
# ─────────────────────────────────────────────────────────────────────────────

BRIDGE_SHARED_SECRET=your-bridge-secret
DEEPLINK_SIGNING_SECRET=your-deeplink-secret
SIGNATURE_SECRET=your-signature-secret
QR_SALT=your-qr-salt
QR_TOKEN_SECRET=your-qr-token-secret
MOMO_SMS_HMAC_SECRET=your-momo-hmac-secret
WALLET_API_KEY=your-wallet-api-key
INSURANCE_OCR_METRICS_TOKEN=your-ocr-metrics-token

# ─────────────────────────────────────────────────────────────────────────────
# OBSERVABILITY [REQUIRED FOR PRODUCTION]
# ─────────────────────────────────────────────────────────────────────────────

OTEL_EXPORTER_OTLP_ENDPOINT=https://api.honeycomb.io
OTEL_SERVICE_NAME=easymo-production
LOG_DRAIN_URL=
METRICS_DRAIN_URL=
ALERT_WEBHOOK_URL=
INSURANCE_OCR_METRICS_WEBHOOK_URL=

# ─────────────────────────────────────────────────────────────────────────────
# RATE LIMITING [RECOMMENDED]
# ─────────────────────────────────────────────────────────────────────────────

ENABLE_RATE_LIMITING=true
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Upstash Redis (optional, for distributed rate limiting)
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# ─────────────────────────────────────────────────────────────────────────────
# FEATURE FLAGS [DEFAULT: OFF]
# ─────────────────────────────────────────────────────────────────────────────

FEATURE_AGENT_NEGOTIATION=false
FEATURE_AGENT_SCHEDULING=false
FEATURE_AGENT_MARKETPLACE=false

# ─────────────────────────────────────────────────────────────────────────────
# MOBILITY CONFIGURATION [OPTIONAL]
# ─────────────────────────────────────────────────────────────────────────────

# Intent cache TTL in minutes
MOBILITY_INTENT_TTL_MINUTES=10

# Trip expiry in minutes
MOBILITY_TRIP_EXPIRY_MINUTES=30

# ─────────────────────────────────────────────────────────────────────────────
# MEDIA PROCESSING [OPTIONAL]
# ─────────────────────────────────────────────────────────────────────────────

MEDIA_TRANSCODE_PRESET_MASTER=
MEDIA_TRANSCODE_PRESET_SOCIAL=
MEDIA_TRANSCODE_PRESET_WHATSAPP=
MEDIA_TRANSCODE_PRESET_AUDIO=

# ─────────────────────────────────────────────────────────────────────────────
# DEVELOPMENT & TESTING [OPTIONAL]
# ─────────────────────────────────────────────────────────────────────────────

# Enable mock data (NEVER set to true in production)
NEXT_PUBLIC_USE_MOCKS=false

# Enable UI Kit v2
NEXT_PUBLIC_UI_V2_ENABLED=false

# WhatsApp send configuration
WHATSAPP_SEND_TIMEOUT_MS=10000
WHATSAPP_SEND_RETRIES=2

# ─────────────────────────────────────────────────────────────────────────────
# DATABASE [OPTIONAL]
# ─────────────────────────────────────────────────────────────────────────────
# For microservices using Prisma (Agent-Core, etc.)

DATABASE_URL=postgresql://postgres:password@localhost:5432/agent_core

# Redis (for caching, queues)
REDIS_URL=redis://localhost:6380

# Kafka (for event streaming)
KAFKA_BROKERS=localhost:19092

# ─────────────────────────────────────────────────────────────────────────────
# DEPLOYMENT PLATFORM VARIABLES
# ─────────────────────────────────────────────────────────────────────────────
# These are typically auto-set by the platform - no need to configure manually

# Netlify (auto-set during builds)
# NETLIFY=true
# CONTEXT=production|deploy-preview|branch-deploy
# URL=https://your-site.netlify.app
# DEPLOY_URL=https://deploy-preview-123--your-site.netlify.app

# Cloud Run / App Engine (auto-set by GCP)
# PORT=8080
# K_SERVICE=service-name
# K_REVISION=service-revision
# GOOGLE_CLOUD_PROJECT=project-id
