# ═══════════════════════════════════════════════════════════════════════════════
# EASYMO ENVIRONMENT CONFIGURATION
# ═══════════════════════════════════════════════════════════════════════════════
# This file documents all environment variables required for EasyMO. 
# Copy to .env.local for development or configure in your deployment platform. 
#
# Legend:
#   [REQUIRED]  - Must be set for the application to function
#   [OPTIONAL]  - Has sensible defaults or optional functionality
#   [SENSITIVE] - Contains secrets, never commit actual values
# ═══════════════════════════════════════════════════════════════════════════════

# ─────────────────────────────────────────────────────────────────────────────
# ADMIN AUTHENTICATION [REQUIRED] [SENSITIVE]
# ─────────────────────────────────────────────────────────────────────────────
# JSON array of admin credentials. Generate strong passwords for production.
# Example structure only - NEVER use these values in production
ADMIN_ACCESS_CREDENTIALS='[{"actorId":"00000000-0000-0000-0000-000000000000","email":"admin@example.com","password":"CHANGE_ME_STRONG_PASSWORD_32_CHARS_MIN","username":"admin"}]'

# WhatsApp flow ID for admin authentication
ADMIN_FLOW_WA_ID=

# Session encryption secret - MINIMUM 64 characters for production
# Generate with: openssl rand -hex 32
ADMIN_SESSION_SECRET=GENERATE_WITH_openssl_rand_hex_32_MINIMUM_64_CHARS
ADMIN_SESSION_SECRET_FALLBACK=GENERATE_ANOTHER_SECRET_FOR_KEY_ROTATION

# Default role for invited users (member, admin, viewer)
ADMIN_INVITE_DEFAULT_ROLE=member

# Invitation link expiry in days
ADMIN_INVITE_EXPIRY_DAYS=14

# ─────────────────────────────────────────────────────────────────────────────
# SUPABASE CONFIGURATION [REQUIRED]
# ─────────────────────────────────────────────────────────────────────────────
# Get these from your Supabase project dashboard: Settings > API

# Public URL (safe for client-side)
NEXT_PUBLIC_SUPABASE_URL=https://your-project-ref.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key

# Server-side only (NEVER expose to client)
SUPABASE_DB_URL=postgresql://postgres:password@db.your-project-ref.supabase.co:5432/postgres
SUPABASE_JWT_SECRET=your-jwt-secret
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# Vite apps (PWAs)
VITE_SUPABASE_URL=https://your-project-ref.supabase.co
VITE_SUPABASE_ANON_KEY=your-anon-key
VITE_SUPABASE_PROJECT_ID=your-project-ref

# ─────────────────────────────────────────────────────────────────────────────
# WHATSAPP BUSINESS API [REQUIRED FOR MESSAGING]
# ─────────────────────────────────────────────────────────────────────────────
WA_PHONE_ID=your-phone-number-id
WA_TOKEN=your-permanent-access-token
WA_VERIFY_TOKEN=your-webhook-verify-token
WA_APP_SECRET=your-app-secret

WABA_ACCESS_TOKEN=your-waba-access-token
WABA_PHONE_NUMBER_ID=your-phone-number-id
WABA_TEMPLATE_NAMESPACE=your-template-namespace
WABA_WEBHOOK_VERIFY_TOKEN=your-webhook-verify-token

WHATSAPP_ACCESS_TOKEN=your-access-token
WHATSAPP_SEND_ENDPOINT=https://graph.facebook.com/v18.0
WHATSAPP_SYSTEM_USER_ID=your-system-user-id
WHATSAPP_TEMPLATE_NAMESPACE=your-template-namespace

META_WABA_BUSINESS_ID=your-business-id

# Admin bypass for development (DISABLE IN PRODUCTION)
WA_ADMIN_BYPASS_ENABLED=false
WA_ADMIN_BYPASS_IPS=

# WhatsApp templates
WA_INSURANCE_ADMIN_TEMPLATE=insurance_admin_alert
WA_TEMPLATE_LANG=en

# ─────────────────────────────────────────────────────────────────────────────
# AI PROVIDERS [OPTIONAL]
# ─────────────────────────────────────────────────────────────────────────────
OPENAI_API_KEY=sk-your-openai-api-key
SORA_API_KEY=your-sora-api-key

# ─────────────────────────────────────────────────────────────────────────────
# OBSERVABILITY [REQUIRED FOR PRODUCTION]
# ─────────────────────────────────────────────────────────────────────────────
OTEL_EXPORTER_OTLP_ENDPOINT=https://api.honeycomb.io
OTEL_SERVICE_NAME=easymo-production
LOG_DRAIN_URL=
METRICS_DRAIN_URL=
ALERT_WEBHOOK_URL=

# ─────────────────────────────────────────────────────────────────────────────
# SECURITY TOKENS [REQUIRED] [SENSITIVE]
# ─────────────────────────────────────────────────────────────────────────────
EASYMO_ADMIN_TOKEN=your-admin-api-token
BRIDGE_SHARED_SECRET=your-bridge-secret
DEEPLINK_SIGNING_SECRET=your-deeplink-secret
SIGNATURE_SECRET=your-signature-secret
QR_SALT=your-qr-salt
QR_TOKEN_SECRET=your-qr-token-secret
MOMO_SMS_HMAC_SECRET=your-momo-hmac-secret
WALLET_API_KEY=your-wallet-api-key
INSURANCE_OCR_METRICS_TOKEN=your-ocr-metrics-token
INSURANCE_OCR_METRICS_WEBHOOK_URL=

# ─────────────────────────────────────────────────────────────────────────────
# RATE LIMITING [RECOMMENDED]
# ─────────────────────────────────────────────────────────────────────────────
ENABLE_RATE_LIMITING=true
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# ─────────────────────────────────────────────────────────────────────────────
# FEATURE FLAGS [DEFAULT: OFF]
# ─────────────────────────────────────────────────────────────────────────────
FEATURE_AGENT_NEGOTIATION=false
FEATURE_AGENT_SCHEDULING=false
FEATURE_AGENT_MARKETPLACE=false

# ─────────────────────────────────────────────────────────────────────────────
# MOBILITY & MEDIA [OPTIONAL]
# ─────────────────────────────────────────────────────────────────────────────
MOBILITY_INTENT_TTL_MINUTES=10
MOBILITY_TRIP_EXPIRY_MINUTES=30
MEDIA_TRANSCODE_PRESET_MASTER=
MEDIA_TRANSCODE_PRESET_SOCIAL=
MEDIA_TRANSCODE_PRESET_WHATSAPP=
MEDIA_TRANSCODE_PRESET_AUDIO=
INSURANCE_OCR_METRICS_WEBHOOK_URL=
META_WABA_BUSINESS_ID=
MOMO_SMS_HMAC_SECRET=
OPENAI_API_KEY=
SORA_API_KEY=
QR_SALT=
QR_TOKEN_SECRET=
SIGNATURE_SECRET=
SUPABASE_DB_URL=
SUPABASE_JWT_SECRET=
SUPABASE_SERVICE_ROLE_KEY=
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
# Never place service-role keys in NEXT_PUBLIC_* or VITE_* variables.
VITE_SUPABASE_URL=
VITE_SUPABASE_ANON_KEY=
VITE_SUPABASE_PROJECT_ID=
WALLET_API_KEY=
WA_APP_SECRET=
WA_PHONE_ID=
WA_TOKEN=
WA_VERIFY_TOKEN=
WABA_ACCESS_TOKEN=
WABA_PHONE_NUMBER_ID=
WABA_TEMPLATE_NAMESPACE=
WABA_WEBHOOK_VERIFY_TOKEN=
WHATSAPP_ACCESS_TOKEN=
WHATSAPP_SEND_ENDPOINT=
WHATSAPP_SYSTEM_USER_ID=
WHATSAPP_TEMPLATE_NAMESPACE=
WA_ADMIN_BYPASS_ENABLED=false
WA_ADMIN_BYPASS_IPS=
LOG_DRAIN_URL=
METRICS_DRAIN_URL=
MEDIA_TRANSCODE_PRESET_MASTER=
MEDIA_TRANSCODE_PRESET_SOCIAL=
MEDIA_TRANSCODE_PRESET_WHATSAPP=
MEDIA_TRANSCODE_PRESET_AUDIO=

# Mobility Service Configuration
# Intent cache TTL in minutes (default: 10)
MOBILITY_INTENT_TTL_MINUTES=10
# Trip expiry in minutes (default: 30)
MOBILITY_TRIP_EXPIRY_MINUTES=30

# AI Agent Feature Flags (default OFF in production)
FEATURE_AGENT_NEGOTIATION=false
FEATURE_AGENT_SCHEDULING=false
FEATURE_AGENT_MARKETPLACE=false
# WhatsApp Template for insurance admin alerts (outside 24h window)
# Ensure this template is approved in WhatsApp Manager with 1 body parameter
WA_INSURANCE_ADMIN_TEMPLATE=insurance_admin_alert
WA_TEMPLATE_LANG=en

# WhatsApp webhook rate limiting
ENABLE_RATE_LIMITING=true
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# Optional: Upstash REST for distributed rate limiting across instances
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=
