{
  "version": "6.4",
  "screens": [
    {
      "id": "s_find_bar",
      "title": "Find a bar",
      "layout": {
        "type": "single_column"
      },
      "data_exchange": {
        "submit": {
          "action": {
            "id": "a_show_results"
          }
        }
      },
      "widgets": [
        {
          "type": "text_input",
          "id": "f_search",
          "label": "Search",
          "placeholder": "Bar name or landmark"
        },
        {
          "type": "dropdown",
          "id": "f_area",
          "label": "Area",
          "options_data_binding": "areas",
          "placeholder": "All areas",
          "helper_text": "Listing updates as bars add locations. Leave blank to search everywhere."
        },
        {
          "type": "footer_buttons",
          "buttons": [
            {
              "id": "BTN_SHOW_RESULTS",
              "title": "Show results",
              "action": {
                "type": "data_exchange",
                "id": "a_show_results",
                "fields": {
                  "q": "${widgets.f_search.value}",
                  "area": "${widgets.f_area.value}"
                }
              }
            }
          ]
        }
      ]
    },
    {
      "id": "s_bar_results",
      "title": "Select a bar",
      "layout": {
        "type": "single_column"
      },
      "widgets": [
        {
          "type": "radio_list",
          "id": "w_bar_list",
          "options_data_binding": "bars",
          "empty_state": {
            "title": "No bars found",
            "body": "Try adjusting your search or area filter."
          }
        },
        {
          "type": "footer_buttons",
          "buttons": [
            {
              "id": "BTN_PREV",
              "title": "Prev",
              "visibility_condition": "${data.page_token_prev} != null",
              "action": {
                "type": "data_exchange",
                "id": "a_paged_bars",
                "page_token": "${data.page_token_prev}",
                "filters": {
                  "q": "${data.q}",
                  "area": "${data.area}"
                }
              }
            },
            {
              "id": "BTN_NEXT",
              "title": "Next",
              "visibility_condition": "${data.page_token_next} != null",
              "action": {
                "type": "data_exchange",
                "id": "a_paged_bars",
                "page_token": "${data.page_token_next}",
                "filters": {
                  "q": "${data.q}",
                  "area": "${data.area}"
                }
              }
            },
            {
              "id": "BTN_BACK_SEARCH",
              "title": "Back",
              "action": {
                "type": "navigate",
                "next": "s_find_bar"
              }
            }
          ]
        }
      ],
      "events": {
        "on_item_select": {
          "widget_id": "w_bar_list",
          "action": {
            "type": "data_exchange",
            "id": "a_select_bar",
            "fields": {
              "bar_id": "${selected.id}"
            }
          }
        }
      }
    },
    {
      "id": "s_bar_detail",
      "title": "Bar details",
      "layout": {
        "type": "single_column"
      },
      "widgets": [
        {
          "type": "text_block",
          "id": "w_bar_summary",
          "text": "${data.bar_name}\n${data.location_text}"
        },
        {
          "type": "footer_buttons",
          "buttons": [
            {
              "id": "BTN_OPEN_MENU",
              "title": "Open menu",
              "action": {
                "type": "data_exchange",
                "id": "a_open_menu",
                "fields": {
                  "bar_id": "${data.bar_id}"
                }
              }
            },
            {
              "id": "BTN_CHAT_BAR",
              "title": "Chat with bar",
              "visibility_condition": "${data.direct_chat_allowed} == 'true'",
              "action": {
                "type": "open_url",
                "url": "${data.bar_chat_url}"
              }
            },
            {
              "id": "BTN_BACK_RESULTS",
              "title": "Back",
              "action": {
                "type": "navigate",
                "next": "s_bar_results"
              }
            }
          ]
        }
      ]
    }
  ]
}
